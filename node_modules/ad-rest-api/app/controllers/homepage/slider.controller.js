const responder = require("../../sender/response.sender");
let access = require("../../service/access.service");
const sliderHomePageService = require("../../service/homepage/slider.service");
let joi = require("joi");
let sliderHomepageModel = require("../../models/homepage/slider.modal");

let sliderHomepageController = {
  getSliderData: getAll,
  postSliderData: post
};

module.exports = sliderHomepageController;

function getAll(req, res) {
  sliderHomePageService.getSliderData(req, function(err, result) {
    responder.response(err, result, res);
  });
}

function post(req, res) {
  if (req.body.token) {
    access.getAccess(req.body.token, res, null, function(err, result) {
      if (err) {
        responder.valiodationFail(res);
      } else {
        if (result[0].idEmployee) {
          req.body.employeeId = result[0].idEmployee;
          joi.validate(req.body, sliderHomepageModel.body, function(
            err,
            value
          ) {
            if (err) {
              responder.valiodationFail(res);
            } else {
              sliderHomePageService.postSliderData(req, function(err, result) {
                responder.response(err, result, res);
              });
            }
          });
        } else {
          responder.valiodationFail(res);
        }
      }
    });
  } else {
    responder.invalidLogin(res);
  }
}
